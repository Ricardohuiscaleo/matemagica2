<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matemágica - Bienvenida</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="Progressive Web App educativa para generar ejercicios de matemáticas con IA, dirigida a estudiantes de primaria">
    <meta name="theme-color" content="#667eea">
    <meta name="background-color" content="#667eea">
    
    <!-- Apple PWA Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Matemágica">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" sizes="152x152" href="icons/icon-152.png">
    <link rel="apple-touch-icon" sizes="144x144" href="icons/icon-144.png">
    <link rel="apple-touch-icon" sizes="128x128" href="icons/icon-128.png">
    <link rel="apple-touch-icon" sizes="96x96" href="icons/icon-96.png">
    <link rel="apple-touch-icon" sizes="72x72" href="icons/icon-72.png">
    
    <!-- Android/Chrome Icons -->
    <link rel="icon" type="image/png" sizes="192x192" href="icons/icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="icons/icon-512.png">
    <link rel="icon" type="image/png" sizes="384x384" href="icons/icon-384.png">
    <link rel="icon" type="image/png" sizes="144x144" href="icons/icon-144.png">
    <link rel="icon" type="image/png" sizes="96x96" href="icons/icon-96.png">
    <link rel="icon" type="image/png" sizes="72x72" href="icons/icon-72.png">
    
    <!-- Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Tailwind CSS local compilado -->
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@300;400;500;600;700&family=Pacifico&display=swap" rel="stylesheet">
    
    <style>
        /* Reset y base */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Variables CSS para colores personalizados - MEJORADO PARA NIÑOS */
        :root {
            /* Gradiente principal más alegre y child-friendly */
            --gradient-magic: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-magic-kids: linear-gradient(135deg, #A8EDEA 0%, #FED6E3 50%, #FFEAA7 100%);
            --gradient-teacher: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --gradient-parent: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            
            /* Nuevos gradientes para un fondo más dinámico */
            --bg-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --bg-kids-friendly: linear-gradient(45deg, #a8edea 0%, #fed6e3 25%, #ffeaa7 50%, #a8edea 75%, #fed6e3 100%);
            --bg-kids-animated: radial-gradient(circle at 20% 50%, #667eea 0%, transparent 50%), 
                                radial-gradient(circle at 80% 20%, #fa709a 0%, transparent 50%), 
                                radial-gradient(circle at 40% 80%, #fee140 0%, transparent 50%), 
                                linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
        }

        html, body {
            height: 100%;
            width: 100%;
            margin: 0;
            padding: 0;
            font-family: 'Fredoka', sans-serif;
            /* NORMALIZAR PESO DE FUENTE A NORMAL */
            font-weight: 400; /* Peso normal por defecto */
            font-variation-settings: normal;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            /* NUEVO FONDO OPTIMIZADO PARA NIÑOS */
            background: var(--bg-kids-animated);
            background-size: 300% 300%;
            animation: fondo-magico 15s ease-in-out infinite;
            overflow-x: hidden;
        }
        
        /* NORMALIZAR FUENTES GLOBALMENTE - SOLO PESO NORMAL */
        *, *::before, *::after {
            font-weight: 400 !important; /* Forzar peso normal en todo */
        }
        
        /* EXCEPCIÓN ESPECIAL: Solo "Matemágica" puede tener cursiva y bold */
        .magic-title, .titulo-magico {
            font-family: 'Pacifico', cursive !important;
            font-weight: 700 !important; /* Solo el título principal */
            font-style: italic !important;
        }
        
        /* Asegurar que otros elementos importantes mantengan peso normal */
        p, span, div, button, a, input, textarea, label, h1, h2, h3, h4, h5, h6 {
            font-weight: 400 !important; /* Peso normal para todo */
        }
        
        /* Excepción solo para el título "Matemágica" */
        h1.magic-title, .titulo-magico {
            font-family: 'Pacifico', cursive !important;
            font-weight: 700 !important;
            font-style: italic !important;
        }

        /* Contenedor principal que FUERZA el centrado */
        .main-container {
            min-height: 100vh;
            width: 100vw;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            padding: 20px;
        }

        /* Tarjeta principal con efecto glassmorphism mejorado */
        .magic-card {
            background: rgb(255, 255, 255);
            backdrop-filter: blur(30px);
            -webkit-backdrop-filter: blur(30px);
            border: 2px solid rgba(255, 255, 255, 0.2);
            box-shadow: 
                0 25px 50px rgba(102, 126, 234, 0.25),
                0 0 0 1px rgba(255, 255, 255, 0.1) inset;
            border-radius: 24px;
            padding: 64px 48px 72px 48px;
            width: 100%;
            max-width: 520px;
            min-height: 640px;
            text-align: center;
            position: relative;
            z-index: 10;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        /* Título con animación de gradiente - OPTIMIZADO PARA MÓVILES */
        .magic-title {
            background: linear-gradient(45deg, #667eea, #764ba2, #f093fb, #f5576c);
            background-size: 400% 400%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: rainbow-text 3s ease-in-out infinite;
            /* CLAMP OPTIMIZADO PARA APROVECHAR ANCHO MÓVIL */
            font-size: clamp(2.2rem, 8vw, 3.2rem);
            font-weight: 600;
            margin-bottom: 32px;
            line-height: 1.3;
            white-space: nowrap;
            text-align: center;
            overflow: visible;
            /* PADDING OPTIMIZADO PARA MÓVILES */
            padding: 8px 10px 20px 10px;
            min-height: 4rem;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 16px;
        }

        /* RESPONSIVE ESPECÍFICO PARA MÓVILES - APROVECHAR ANCHO COMPLETO */
        @media (max-width: 480px) {
            .magic-title {
                font-size: clamp(2.5rem, 9vw, 3.5rem); /* MÁS GRANDE en móviles */
                padding: 8px 5px 20px 5px; /* Menos padding lateral */
                min-height: 4.5rem; /* Más altura para la "g" */
                margin-bottom: 24px; /* Menos margen inferior */
            }
        }

        /* RESPONSIVE PARA TABLETAS */
        @media (min-width: 481px) and (max-width: 768px) {
            .magic-title {
                font-size: clamp(2.8rem, 7vw, 3.5rem);
            }
        }

        /* RESPONSIVE PARA ESCRITORIO */
        @media (min-width: 769px) {
            .magic-title {
                font-size: clamp(3.2rem, 6vw, 4rem);
            }
        }

        .subtitle {
            font-size: 1.125rem;
            color: #64748b;
            margin-bottom: 8px;
        }

        .adventure-text {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 32px;
            color: #d97706;
            font-size: 0.875rem;
        }

        .section-title {
            font-size: 1.5rem;
            color: #334155;
            margin-bottom: 24px;
            font-weight: 600;
        }

        /* Botones de rol mejorados - ALTURA CORREGIDA */
        .role-btn {
            width: 100%;
            padding: 32px 32px 28px 32px; /* Más padding vertical */
            min-height: 120px; /* Altura mínima garantizada */
            border-radius: 20px;
            font-weight: 700;
            font-size: 1.125rem;
            border: none;
            cursor: pointer;
            position: relative;
            overflow: visible; /* Cambiar de hidden a visible */
            transform: translateY(0);
            transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            margin: 12px 0;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 8px; /* Espacio entre elementos internos */
        }

        .role-btn:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.25);
        }

        .role-btn-teacher {
            background: var(--gradient-teacher);
            color: white;
        }

        .role-btn-parent {
            background: var(--gradient-parent);
            color: white;
        }

        .role-btn-admin {
            background: linear-gradient(135deg, #ff416c 0%, #ff4b2b 50%, #ff6b35 100%);
            color: white;
            position: relative;
            overflow: hidden;
        }

        .role-btn-admin::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, 
                rgba(255, 255, 255, 0.1) 0%, 
                transparent 50%, 
                rgba(255, 255, 255, 0.1) 100%);
            animation: admin-shine 3s ease-in-out infinite;
        }

        @keyframes admin-shine {
            0%, 100% { transform: translateX(-100%); }
            50% { transform: translateX(100%); }
        }

        .btn-content {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-bottom: 6px; /* Más espacio entre contenido y descripción */
            line-height: 1.2; /* Mejor altura de línea */
        }

        .btn-emoji {
            font-size: 1.8rem; /* Ligeramente más pequeño para dar espacio */
            line-height: 1;
        }

        .btn-description {
            font-size: 0.875rem;
            opacity: 0.9;
            margin-top: 0; /* Quitar margin-top ya que usamos gap */
            line-height: 1.3;
            font-weight: 500; /* Menos bold para la descripción */
        }

        /* Efecto shimmer */
        .role-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s;
        }

        .role-btn:hover::before {
            left: 100%;
        }

        /* Elementos flotantes */
        .floating-elements {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
            z-index: 1;
        }

        .floating-math {
            position: absolute;
            font-size: 28px; /* Más grandes */
            opacity: 0.25; /* Más visibles */
            animation: float-around 25s linear infinite;
            color: white;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
            font-weight: bold;
        }

        @keyframes float-around {
            0% { transform: translateY(100vh) rotate(0deg); }
            100% { transform: translateY(-100px) rotate(360deg); }
        }

        /* Animación suave del fondo para hacerlo más dinámico */
        @keyframes fondo-magico {
            0%, 100% {
                background-position: 0% 50%;
            }
            33% {
                background-position: 100% 0%;
            }
            66% {
                background-position: 0% 100%;
            }
        }

        /* Mensajes de error amigables */
        .error-friendly {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
            color: #8b4513;
            border: 2px solid #ff9a9e;
            border-radius: 15px;
            font-weight: 600;
            padding: 15px 20px;
            box-shadow: 0 8px 25px rgba(255, 154, 158, 0.3);
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
            display: none;
        }

        /* Animación de pulsación suave */
        .pulse-gentle {
            animation: pulse-gentle 2s ease-in-out infinite;
        }

        @keyframes pulse-gentle {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.9; }
        }

        /* Loading overlay - PANTALLA COMPLETA MEJORADA */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg-kids-animated);
            background-size: 300% 300%;
            animation: fondo-magico 15s ease-in-out infinite;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000; /* Muy alto para cubrir todo */
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .loading-content {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            padding: 60px 40px;
            border-radius: 24px;
            text-align: center;
            max-width: 400px;
            width: 90%;
            box-shadow: 
                0 25px 50px rgba(102, 126, 234, 0.25),
                0 0 0 1px rgba(255, 255, 255, 0.2) inset;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        /* Spinner mágico mejorado */
        .fun-spinner {
            width: 80px;
            height: 80px;
            border: 6px solid rgba(102, 126, 234, 0.1);
            border-top: 6px solid #667eea;
            border-radius: 50%;
            animation: spin-fun 1.5s linear infinite;
            position: relative;
            margin: 0 auto 24px;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
        }

        .fun-spinner::after {
            content: '🧮';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 28px;
            animation: bounce-magico 2s ease-in-out infinite;
        }

        @keyframes spin-fun {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes bounce-magico {
            0%, 100% { 
                transform: translate(-50%, -50%) scale(1); 
            }
            50% { 
                transform: translate(-50%, -50%) scale(1.3); 
            }
        }

        /* Texto de carga animado */
        .loading-text {
            color: #334155;
            font-weight: 700;
            font-size: 1.2rem;
            margin-bottom: 16px;
            animation: pulse-text 2s ease-in-out infinite;
        }

        .loading-subtitle {
            color: #64748b;
            font-size: 0.9rem;
            opacity: 0.8;
            line-height: 1.4;
        }

        @keyframes pulse-text {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.05); }
        }

        /* Puntos de carga animados */
        .loading-dots {
            display: inline-block;
            position: relative;
            width: 80px;
            height: 20px;
            margin-top: 20px;
        }

        .loading-dots div {
            position: absolute;
            top: 50%;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #667eea;
            animation: loading-dots 1.2s linear infinite;
        }

        .loading-dots div:nth-child(1) { left: 8px; animation-delay: 0s; }
        .loading-dots div:nth-child(2) { left: 32px; animation-delay: 0.4s; }
        .loading-dots div:nth-child(3) { left: 56px; animation-delay: 0.8s; }

        @keyframes loading-dots {
            0%, 80%, 100% {
                transform: translateY(-50%) scale(0);
                opacity: 0.5;
            }
            40% {
                transform: translateY(-50%) scale(1);
                opacity: 1;
            }
        }

        /* Responsive */
        @media (min-width: 640px) {
            .magic-title {
                font-size: 4rem;
            }
            .magic-card {
                padding: 64px;
            }
        }

        /* Ocultar pantallas por defecto */
        .hidden-screen {
            display: none !important;
        }

        /* Asegurar centrado en pantalla de auth */
        .auth-screen {
            min-height: 100vh;
            width: 100vw;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            z-index: 10;
            padding: 20px;
        }

        .auth-card {
            background: rgb(255, 255, 255);
            backdrop-filter: blur(30px);
            -webkit-backdrop-filter: blur(30px);
            border: 2px solid rgba(255, 255, 255, 0.2);
            box-shadow: 
                0 25px 50px rgba(102, 126, 234, 0.25),
                0 0 0 1px rgba(255, 255, 255, 0.1) inset;
            border-radius: 24px;
            padding: 56px 48px;
            width: 100%;
            max-width: 420px;
            min-height: 480px;
            text-align: center;
            position: relative;
            z-index: 10;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .auth-emoji {
            font-size: 3rem;
            margin-bottom: 16px;
        }

        .auth-title {
            font-size: 2rem;
            color: #4f46e5;
            margin-bottom: 16px;
            font-weight: 700;
        }

        .auth-subtitle {
            color: #64748b;
            margin-bottom: 24px;
        }

        .google-btn {
            background: white;
            color: #374151;
            border: 2px solid #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            width: 100%;
            padding: 16px 24px;
            border-radius: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .google-btn:hover {
            background: #f8fafc;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }

        .security-text {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-top: 16px;
            font-size: 0.75rem;
            color: #64748b;
        }

        .back-btn {
            margin-top: 24px;
            color: #64748b;
            font-size: 0.875rem;
            cursor: pointer;
            transition: color 0.3s;
        }

        .back-btn:hover {
            color: #334155;
        }

        /* Contenedor de la tarjeta con flip 3D - DIMENSIONES AUMENTADAS */
        .card-flip-container {
            perspective: 1000px;
            width: 100%;
            max-width: 600px; /* Aumentado de 520px a 600px */
            min-height: 720px; /* Aumentado de 640px a 720px */
            position: relative;
        }

        .card-flipper {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.8s cubic-bezier(0.23, 1, 0.32, 1);
            transform-style: preserve-3d;
        }

        /* Cuando tiene la clase 'flipped', se voltea */
        .card-flipper.flipped {
            transform: rotateY(180deg);
        }

        /* Estilos base para ambas caras de la tarjeta - DIMENSIONES AUMENTADAS */
        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            background: #ffffff;
            border: 2px solid #d2d2d2;
            box-shadow: 
                0 25px 50px rgba(102, 126, 234, 0.15),
                0 10px 20px rgba(0, 0, 0, 0.1);
            border-radius: 24px;
            padding: 72px 56px 80px 56px; /* Aumentado padding: top/bottom y left/right */
            text-align: center;
            z-index: 10;
            display: flex;
            flex-direction: column;
            justify-content: center;
            min-height: 720px; /* Aumentado de 640px a 720px */
            max-height: 720px; /* Aumentado de 640px a 720px */
            overflow: hidden;
        }

        /* Cara frontal (bienvenida) */
        .card-front {
            transform: rotateY(0deg);
        }

        /* Cara trasera (autenticación) - MISMO estilo aumentado */
        .card-back {
            transform: rotateY(180deg);
            padding: 72px 56px 80px 56px; /* Mismo padding aumentado */
            min-height: 720px; /* Aumentado de 640px a 720px */
            max-height: 720px; /* Aumentado de 640px a 720px */
        }

        /* FORZAR FUENTES NORMALES - SOLUCIÓN DEFINITIVA */
        *, *::before, *::after,
        h1, h2, h3, h4, h5, h6,
        p, span, div, button, a, input, textarea, label,
        .role-btn, .btn-content, .btn-description,
        .auth-title, .section-title, .loading-text,
        .google-btn, .back-btn {
            font-weight: 400 !important; /* Peso normal para TODO */
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif !important;
        }

        /* ELIMINAR FREDOKA COMPLETAMENTE */
        body, html {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif !important;
            font-weight: 400 !important;
        }

        /* ÚNICA EXCEPCIÓN: Solo "Matemágica" */
        .magic-title {
            font-family: 'Pacifico', cursive !important;
            font-weight: 700 !important;
            font-style: italic !important;
        }

        /* ANULAR TODAS LAS FUENTES GRUESAS ESPECÍFICAS */
        .role-btn {
            font-weight: 400 !important; /* Cambiar de 700 a 400 */
        }

        .section-title {
            font-weight: 400 !important; /* Cambiar de 600 a 400 */
        }

        .auth-title {
            font-weight: 400 !important; /* Cambiar de 700 a 400 */
        }

        .loading-text {
            font-weight: 400 !important; /* Cambiar de 700 a 400 */
        }

        .google-btn {
            font-weight: 400 !important; /* Cambiar de 600 a 400 */
        }
    </style>
</head>
<body>
    <!-- Elementos flotantes decorativos - MOVIMIENTO DISPERSO -->
    <div class="floating-elements">
        <div class="floating-math" style="left: 10%; animation-delay: 0s; animation-duration: 20s;">➕</div>
        <div class="floating-math" style="left: 20%; animation-delay: 7s; animation-duration: 25s;">➖</div>
        <div class="floating-math" style="left: 30%; animation-delay: 2s; animation-duration: 22s;">🔢</div>
        <div class="floating-math" style="left: 40%; animation-delay: 12s; animation-duration: 28s;">✨</div>
        <div class="floating-math" style="left: 50%; animation-delay: 5s; animation-duration: 24s;">📚</div>
        <div class="floating-math" style="left: 60%; animation-delay: 15s; animation-duration: 26s;">🎯</div>
        <div class="floating-math" style="left: 70%; animation-delay: 3s; animation-duration: 23s;">⭐</div>
        <div class="floating-math" style="left: 80%; animation-delay: 18s; animation-duration: 27s;">🏆</div>
        <div class="floating-math" style="left: 90%; animation-delay: 8s; animation-duration: 21s;">🎉</div>
        <!-- Agregamos más emojis para mayor dispersión -->
        <div class="floating-math" style="left: 15%; animation-delay: 10s; animation-duration: 29s;">📊</div>
        <div class="floating-math" style="left: 35%; animation-delay: 1s; animation-duration: 26s;">🧮</div>
        <div class="floating-math" style="left: 55%; animation-delay: 14s; animation-duration: 22s;">🎲</div>
        <div class="floating-math" style="left: 75%; animation-delay: 6s; animation-duration: 25s;">🌟</div>
        <div class="floating-math" style="left: 85%; animation-delay: 11s; animation-duration: 24s;">🎊</div>
    </div>

    <!-- Mensaje de error -->
    <div id="error-display" class="error-friendly"></div>

    <!-- Pantalla principal con tarjeta flip -->
    <div id="main-screen" class="main-container">
        <div class="card-flip-container">
            <div id="card-flipper" class="card-flipper">
                <!-- Cara frontal: Bienvenida -->
                <div class="card-face card-front">
                    <h1 class="magic-title">🧮 Matemágica</h1>
                    <p class="subtitle">¡Panel de Administración!</p>
                    <div class="adventure-text">
                        <span>🔧 Acceso Administrativo 🔧</span>
                    </div>
                    
                    <h2 class="section-title">Acceso Exclusivo</h2>
                    
                    <button id="admin-role-btn" class="role-btn role-btn-admin">
                        <div class="btn-content">
                            <span class="btn-emoji">🔧</span>
                            <span>Soy Administrador</span>
                            <span class="btn-emoji">👑</span>
                        </div>
                        <p class="btn-description">Acceso completo al sistema</p>
                    </button>
                </div>

                <!-- Cara trasera: Autenticación -->
                <div class="card-face card-back">
                    <div class="auth-emoji">🎉</div>
                    <h1 class="auth-title">¡Genial!</h1>
                    <p class="auth-subtitle">Vamos a entrar a tu cuenta de forma segura</p>
                    
                    <button id="google-auth-btn" class="google-btn">
                        <svg width="24" height="24" viewBox="0 0 48 48">
                            <path fill="#FFC107" d="M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"></path>
                            <path fill="#FF3D00" d="M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"></path>
                            <path fill="#4CAF50" d="M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"></path>
                            <path fill="#1976D2" d="M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571l6.19,5.238C41.332,36.191,44,30.651,44,24C44,22.659,43.862,21.35,43.611,20.083z"></path>
                        </svg>
                        <span>Entrar con Google</span>
                    </button>
                    
                    <div class="security-text">
                        <span>🔒</span>
                        <span>Tu información está segura</span>
                        <span>🔒</span>
                    </div>
                    
                    <button id="back-to-welcome-btn" class="back-btn">
                        ← Volver a elegir rol
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading overlay -->
    <div id="loading-overlay" class="loading-overlay hidden-screen">
        <div class="loading-content">
            <div class="fun-spinner"></div>
            <p class="loading-text">¡Preparando tu aventura matemática!</p>
            <p class="loading-subtitle">Conectando de forma segura...</p>
            <div class="loading-dots">
                <div></div>
                <div></div>
                <div></div>
            </div>
        </div>
    </div>

    <!-- Scripts de autenticación funcional -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    
    <!-- ✅ CONFIG SERVICE - DEBE CARGAR PRIMERO -->
    <script src="js/config-service.js"></script>
    
    <!-- ✅ SISTEMA DE SECRETOS SEGURO CON CLOAK v2.0 -->
    <script src="js/secure-secrets.js"></script>
    
    <!-- ✅ AUTH.JS CON SOPORTE COMPLETO PARA CLOAK -->
    <script src="js/auth.js"></script>
    
    <script>
        // 🔄 Funciones para controlar el flip de la tarjeta
        function flipTarjeta(mostrarReverso = true) {
            console.log('🔄 Flip de tarjeta:', mostrarReverso ? 'mostrando reverso' : 'mostrando frente');
            
            const cardFlipper = document.getElementById('card-flipper');
            if (cardFlipper) {
                if (mostrarReverso) {
                    cardFlipper.classList.add('flipped');
                    console.log('✅ Tarjeta volteada al reverso (autenticación)');
                } else {
                    cardFlipper.classList.remove('flipped');
                    console.log('✅ Tarjeta volteada al frente (bienvenida)');
                }
            } else {
                console.error('❌ No se encontró el elemento card-flipper');
            }
        }

        // 🔙 Función para volver a la cara frontal
        function volverABienvenida() {
            console.log('🔙 Volviendo a la cara frontal de la tarjeta...');
            
            // Limpiar el rol seleccionado
            localStorage.removeItem('matemagica_selected_role');
            
            // Voltear la tarjeta de vuelta al frente
            flipTarjeta(false);
        }

        // 📋 Función para mostrar/ocultar pantalla de carga
        function mostrarCargando(mostrar) {
            console.log('⏳ Loading overlay:', mostrar ? 'mostrando' : 'ocultando');
            
            const loadingOverlay = document.getElementById('loading-overlay');
            if (loadingOverlay) {
                if (mostrar) {
                    loadingOverlay.classList.remove('hidden-screen');
                } else {
                    loadingOverlay.classList.add('hidden-screen');
                }
            }
        }

        // ⚠️ Función para mostrar mensajes de error
        function mostrarError(mensaje) {
            console.log('⚠️ Mostrando error:', mensaje);
            
            const errorDisplay = document.getElementById('error-display');
            if (errorDisplay) {
                errorDisplay.textContent = mensaje;
                errorDisplay.style.display = 'block';
                
                // Auto-ocultar después de 5 segundos
                setTimeout(() => {
                    errorDisplay.style.display = 'none';
                }, 5000);
            }
        }

        // 🎮 Inicialización cuando se carga la página
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🎮 Matemágica con flip card iniciando...');
            
            // Asegurar que empezamos en la cara frontal
            flipTarjeta(false);
            
            // 🎯 Event listeners para todos los botones
            const teacherBtn = document.getElementById('teacher-role-btn');
            const parentBtn = document.getElementById('parent-role-btn');
            const adminBtn = document.getElementById('admin-role-btn');
            const googleBtn = document.getElementById('google-auth-btn');
            const backBtn = document.getElementById('back-to-welcome-btn');
            
            if (teacherBtn) {
                teacherBtn.addEventListener('click', function() {
                    seleccionarRol('teacher');
                });
            }
            
            if (parentBtn) {
                parentBtn.addEventListener('click', function() {
                    seleccionarRol('parent');
                });
            }
            
            if (adminBtn) {
                adminBtn.addEventListener('click', function() {
                    seleccionarRol('admin');
                });
            }
            
            if (googleBtn) {
                googleBtn.addEventListener('click', function() {
                    iniciarAutenticacion();
                });
            }
            
            if (backBtn) {
                backBtn.addEventListener('click', function() {
                    volverABienvenida();
                });
            }
            
            console.log('✅ Todos los event listeners configurados para flip card');
        });

        // 👤 Función para seleccionar rol con flip de tarjeta - INTEGRADA
        function seleccionarRol(rol) {
            console.log('👤 Rol seleccionado:', rol);
            
            // NUEVO: Notificar al sistema de auth.js
            if (window.loginSystem) {
                window.loginSystem.selectRole(rol);
            } else {
                // Fallback si auth.js no está listo
                localStorage.setItem('matemagica_selected_role', rol);
            }
            
            // Feedback visual en el botón seleccionado
            const botonId = rol === 'teacher' ? 'teacher-role-btn' : 'parent-role-btn';
            const boton = document.getElementById(botonId);
            
            if (boton) {
                // Efecto visual de selección
                boton.style.transform = 'scale(1.1)';
                boton.style.boxShadow = '0 0 30px rgba(102, 126, 234, 0.6)';
                
                // Después del efecto, voltear la tarjeta
                setTimeout(() => {
                    boton.style.transform = '';
                    boton.style.boxShadow = '';
                    flipTarjeta(true); // Mostrar el reverso (autenticación)
                }, 300);
            } else {
                // Si no encuentra el botón, voltear directamente
                flipTarjeta(true);
            }
        }

        // 🔐 Función para iniciar autenticación - INTEGRADA CON AUTH.JS
        function iniciarAutenticacion() {
            console.log('🔐 Iniciando autenticación...');
            
            // Verificar que hay un rol seleccionado
            const rolSeleccionado = localStorage.getItem('matemagica_selected_role');
            if (!rolSeleccionado) {
                mostrarError('🎭 ¡Primero elige si eres profesor o apoderado!');
                return;
            }
            
            // Llamar al sistema real de auth.js
            if (window.loginSystem) {
                window.loginSystem.signInWithGoogle();
            } else {
                console.error('❌ Sistema de auth no disponible');
                mostrarError('🔧 Sistema de autenticación no está listo. ¡Recarga la página!');
            }
        }
    </script>
</body>
</html>
